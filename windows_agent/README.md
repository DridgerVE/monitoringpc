# Client Agent

## Requirements

  * Python 3.5.x
  * [Visual C++ Build Tools 2015](http://go.microsoft.com/fwlink/?LinkId=691126)
  * PyInstaller 3.2

## Install requirements, build and run service

    Важно, чтобы сущуствовала переменная окружения PYTHONPATH с правильным путем
    set PYTHONPATH=C:\Users\admin\AppData\Local\Programs\Python\Python36-32\
    Запуск от имени администратора install.bat

## Clean

    Запуск от имени администратора uninstall.bat

## Описание работы

    1. Параметры подключения к серверу лежат в реестре, а также версия сборки ОС и уникальный идентификатор
    2. Логирование в журнал Windows (журнал приложений)
    3. Собираем следующую информацию:
        уникальный идентификатор (если в реестре отсутствует, то используем mac-адрес),
        имя хоста,
        время включения хоста (по сути старта службы),
        время выключения хоста (остановка службы),
        имя домена и активного пользователя (используем обертку wmi),
        время входа пользователя в систему и время выхода из системы
    4. Push серверу происходит при старте и остановке, а также раз в 30 секунд (отпраляются события "login", "logoff", "state")
